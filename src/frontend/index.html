<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TheGreenSOLution</title>
    <link rel="stylesheet" href="stile.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>TheGreenSOLution</h1>
            <div class="navbar-container">
                <nav>
                    <ul>
                        <li><a href="#" class="current">Home</a></li>
                        <li><a href="contribuisci.html">Buy Trees</a></li>
                        <li><a href="#">Projects</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </nav>
                <button id="auth-button" class="login-button" onclick="handleAuthClick()">LOGIN</button>
                <span id="login-message" class="message">You are not logged in</span>
            </div>
        </div>        
    </header>
    
    <!--<section class="token-contatori">
        <h2>Our contribution to the planet</h2>
        <div class="contribution">
            <p><strong>CO2 Restored:</strong> <span id="co2-value">0</span> kg</p>
            <p><strong>Trees planted:</strong> <span id="trees-value">0</span></p>
            <p><strong>Improvement of Society:</strong> <span id="society-value">0</span> %</p>
        </div>
    </section>-->
    <section class="main-content">
        <div class="container">
            <h2 style="color: white;">Welcome to PlanetSaver!</h2>
            <p style="color: white;">Here you can buy trees and participate in activities to save the planet.</p>
            
            <div class="project">
                <img src="./img/1.webp" alt="Project Image" class="project-image">
                <h3>Fighting Illegal Deforestation</h3>
                <p><strong>Region:</strong> South America</p>
                <p><strong>Tree Type:</strong> Pine</p>
                <div class="button-container">
                    <a href="./contribuisci.html" class="purchase-button">Contribuisci Ora</a>
                </div>
            </div>
            
            <div class="project">
                <img src="./img/2.webp" alt="Project Image" class="project-image">
                <h3>Restore olive groves affected by Xylella</h3>
                <p><strong>Region:</strong> Europe, Italy</p>
                <p><strong>Tree Type:</strong> Ulivi</p>
                <div class="button-container">
                    <a href="./contribuisci.html" class="purchase-button">Contribuisci Ora</a>
                </div>
            </div>
            <div class="project">
                <img src="./img/3.webp" alt="Project Image" class="project-image">
                <h3>Restoring CO2</h3>
                <p><strong>Region:</strong> Europe, Italy</p>
                <p><strong>Tree Type:</strong> Querce</p>
                <div class="button-container">
                    <a href="./contribuisci.html" class="purchase-button">Contribuisci Ora</a>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2024 PlanetSaver. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Funzione per controllare lo stato di autenticazione dal server
        async function checkAuthStatus() {
            try {
                const response = await fetch('/auth-status');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const data = await response.json();
                return data.authenticated;
            } catch (error) {
                console.error('Errore nel controllare lo stato di autenticazione:', error);
                return false;
            }
        }

        // Mostra o nasconde il messaggio basato sullo stato di login
        async function showLoginMessage() {
            const messageElement = document.getElementById('login-message');
            const authButton = document.getElementById('auth-button');
            const isLoggedIn = await checkAuthStatus();
            
            if (isLoggedIn) {
                messageElement.textContent = 'Login effettuato con successo';
                messageElement.className = 'message success';
                messageElement.style.display = 'inline';
                authButton.textContent = 'LOGOUT';
                authButton.onclick = () => location.href = '/logout';
            } else {
                messageElement.textContent = 'Non sei loggato';
                messageElement.className = 'message error';
                messageElement.style.display = 'inline';
                authButton.textContent = 'LOGIN';
                authButton.onclick = () => location.href = '/login';
            }
        }

        // Chiama la funzione quando la pagina Ã¨ caricata
        window.onload = showLoginMessage;
    </script>
</body>
</html>