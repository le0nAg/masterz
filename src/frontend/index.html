<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TheGreenSOLution</title>
    <link rel="stylesheet" href="stile.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>TheGreenSOLution</h1>
            <div class="navbar-container">
                <nav>
                    <ul>
                        <li><a href="#" class="current">Home</a></li>
                        <li><a href="contribuisci.html">Buy Trees</a></li>
                        <li><a href="#">Projects</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </nav>
                <button id="auth-button" class="login-button" onclick="handleAuthClick()">LOGIN</button>
                <span id="login-message" class="message">You are not logged in</span>
            </div>
        </div>        
    </header>
    
    <!-- (Il resto del tuo HTML rimane invariato) -->

    <section class="main-content">
        <div class="container">
            <h2 style="color: white;">Welcome to TheGreenSOLution!</h2>
            <p style="color: white;">Here you can buy trees and participate in activities to save the planet.</p>
            
            <div class="project">
                <img src="./img/1.webp" alt="Project Image" class="project-image">
                <h3>Fighting Illegal Deforestation</h3>
                <p><strong>Region:</strong> South America</p>
                <p><strong>Tree Type:</strong> Pines</p>
                <div class="button-container">
                    <a href="./contribuisci.html" class="purchase-button">Contribuisci Ora</a>
                </div>
            </div>
            
            <div class="project">
                <img src="./img/2.webp" alt="Project Image" class="project-image">
                <h3>Restore olive groves affected by Xylella</h3>
                <p><strong>Region:</strong> Europe, Italy</p>
                <p><strong>Tree Type:</strong> Olive Trees</p>
                <div class="button-container">
                    <a href="./contribuisci.html" class="purchase-button">Contribuisci Ora</a>
                </div>
            </div>
            <div class="project">
                <img src="./img/3.webp" alt="Project Image" class="project-image">
                <h3>Restoring CO2</h3>
                <p><strong>Region:</strong> Europe, Italy</p>
                <p><strong>Tree Type:</strong> Oaks</p>
                <div class="button-container">
                    <a href="./contribuisci.html" class="purchase-button">Contribuisci Ora</a>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2024 PlanetSaver. All rights reserved.</p>
        </div>
    </footer>

    <script type="module">
        import { connectWallet, checkAuthStatus } from './wallet-auth.js';

        async function handleAuthClick() {
            try {
                const walletAddress = await connectWallet();
                await showLoginMessage(walletAddress);
            } catch (error) {
                console.error('Error connecting wallet:', error);
            }
        }

        async function showLoginMessage(walletAddress) {
            const messageElement = document.getElementById('login-message');
            const authButton = document.getElementById('auth-button');

            if (walletAddress) {
                messageElement.textContent = `Logged in with wallet: ${walletAddress}`;
                messageElement.className = 'message success';
                messageElement.style.display = 'inline';
                authButton.textContent = 'LOGOUT';
                authButton.onclick = () => handleLogout();
            } else {
                messageElement.textContent = 'You are not logged in';
                messageElement.className = 'message error';
                messageElement.style.display = 'inline';
                authButton.textContent = 'LOGIN';
                authButton.onclick = () => handleAuthClick();
            }
        }

        function handleLogout() {
            window.solana.disconnect();
            showLoginMessage(null);
        }

        // Chiama la funzione quando la pagina Ã¨ caricata
        window.onload = async () => {
            const walletAddress = await checkAuthStatus();
            await showLoginMessage(walletAddress);
        };
    </script>
</body>
</html>

